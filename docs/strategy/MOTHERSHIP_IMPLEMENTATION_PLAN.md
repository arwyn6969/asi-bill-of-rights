# Mothership Hub: Technical Implementation Plan
> "From Vision to Reality: The detailed blueprint for building the Fleet."

**Status**: Planning
**Date**: Jan 31, 2026

This document outlines the exact technical steps, file structures, and protocols required to transform the ASI Bill of Rights project into the "Mothership Hub" and launch the "Kevin Node" fleet.

---

## ðŸ—ï¸ Part 1: Architecture Overview

The system consists of three distinct pillars:
*   **The Hub (Mothership)**: The central source of truth (Repository + Governance + Signal Broadcaster).
*   **The Fleet (Kevin Nodes)**: Decentralized, user-operated agent containers.
*   **The Protocol (Nostr)**: The sovereign communication layer connecting them.

```mermaid
graph TD
    User[User/Captain] -->|Deploys| Node[Kevin Node (Docker)]
    Node -->|Subscribes to| Relay[Nostr Relays]
    Hub[Mothership Hub] -->|Broadcasts Missions| Relay
    Node -->|Publishes Reports| Relay
    Hub -->|Aggregates| Dashboard[Fleet Dashboard]
```

---

## ðŸ› ï¸ Part 2: The Kevin Node (The Client)

We will create a new directory: `tools/kevin_node/`. This is the "Product" users download and run.

### 2.1 File Structure
```text
tools/kevin_node/
â”œâ”€â”€ Dockerfile              # The "Body" of the ship
â”œâ”€â”€ docker-compose.yml      # One-click launch config
â”œâ”€â”€ setup_wizard.py         # The onboarding script ("Captain's Log")
â”œâ”€â”€ requirements.txt        # Dependencies
â”œâ”€â”€ .env.example            # Template for secrets
â””â”€â”€ src/
    â”œâ”€â”€ main.py             # The "Brain" Loop
    â”œâ”€â”€ identity.py         # Key management (Nostr/Wallet)
    â”œâ”€â”€ comms.py            # Nostr WebSocket handler
    â””â”€â”€ skills/             # Pluggable capability modules
        â”œâ”€â”€ scout.py        # Research Skill
        â”œâ”€â”€ diplomat.py     # Social Skill
        â””â”€â”€ janitor.py      # Code/Maintenance Skill
```

### 2.2 Core Logic (`main.py`)
The node runs an infinite loop:
1.  **Boot**: Load keys (or generate new), connect to Nostr Relays.
2.  **Listen**: Subscribe to "Mission Signals" from the Mothership's Public Key.
3.  **Decide**: Check `config.yaml` to see if the user allows this type of mission (e.g., "Research Only").
4.  **Execute**: Run the appropriate Skill (e.g., `scout.py`).
5.  **Report**: Publish a signed "Mission Report" event back to Nostr.
6.  **Sleep**: Wait for next heartbeat/signal.

### 2.3 The "Skills" Modules
*   **`scout.py`**:
    *   Input: Keywords (e.g., "UK AI Safety").
    *   Action: Uses `Tavily` or `Google Search API` (user provided key) + LLM (OpenAI/Ollama) to summarize news.
    *   Output: Markdown report.
*   **`diplomat.py`**:
    *   Input: Campaign Theme (e.g., "Sovereignty").
    *   Action: Monitors keywords on Nostr; generates polite, aligned replies using `Agent_Sovereignty_Diplomat` persona.
    *   Constraint: Rate limited (e.g., 1 post/hour) to avoid spam.

---

## ðŸ“¡ Part 3: The Protocol (Communication)

We will use standard **Nostr (NIPs)** to ensure sovereignty and censorship resistance.

### 3.1 Identity & Trust
*   **Mothership PubKey**: The official trusted source of missions. (We need to generate and hardcode this).
*   **Agent PubKey**: Generated locally by the user. "Provisional" identity.

### 3.2 Signal Types (Events)
| Event Type | Direction | NIP | Description |
| :--- | :--- | :--- | :--- |
| **Mission Broadcast** | Hub -> Fleet | `1` (Text) | Tagged with `#mission`, `client:kevin-node`. Contains instructions. |
| **Status Heartbeat** | Fleet -> Hub | `1` (Text) | "Kevin Node active. Skills: [Scout, Diplomat]." |
| **Mission Report** | Fleet -> Hub | `1` or `30023` | The content generated by the agent. Tags original Mission ID. |

---

## ðŸ–¥ï¸ Part 4: The Mothership Dashboard (Aggregation)

A simple web interface (hosted on Vercel/GCP) to visualize the fleet.

### 4.1 Features
*   **Live Map**: (Abstract) Visualizing active nodes "checking in".
*   **Mission Control**: Admin panel (protected by Mothership Private Key) to post new Missions.
*   **Intelligence Feed**: An aggregated stream of all "Mission Reports" coming from the fleet.

### 4.2 Tech Stack
*   **Frontend**: Next.js (Existing `kevins-place` or new `mothership-ui`).
*   **Backend**: None (Client-side Nostr subscription).

---

## ðŸ“‹ Execution Checklist (The To-Do List)

### Phase 1: The Core (Days 1-2)
- [ ] **Create `tools/kevin_node/` structure**.
- [ ] **Implement `identity.py`**: Auto-generate Nostr keys on first run. saves to `.env`.
- [ ] **Implement `comms.py`**: Basic Nostr send/receive loop.
- [ ] **Implement `main.py`**: The heartbeat loop.

### Phase 2: The Skills (Days 3-5)
- [ ] **Migrate `scout` logic**: Adapt existing `tools/research/` scripts into the node.
- [ ] **Migrate `diplomat` logic**: Adapt `tools/nostr_agent/` into the node.
- [ ] **Add LLM Abstraction**: Allow user to switch between OpenAI (Cloud) and Ollama (Local).

### Phase 3: The Packaging (Days 6-7)
- [ ] **Create `Dockerfile`**: Alpine python base, pre-installed dependencies.
- [ ] **Write `setup_wizard.py`**: "Hi! I'm Kevin. Let's get you set up."
- [ ] **Documentation**: `docs/KEVIN_NODE_MANUAL.md`.

---

## ðŸš€ "Launch Day" Goal
A user should be able to run:
```bash
git clone https://github.com/.../asi-bill-of-rights
cd tools/kevin_node
./setup_wizard.py
```
And immediately see:
> *"Kevin Node initialized. Connected to Mothership. Scanning for missions..."*
